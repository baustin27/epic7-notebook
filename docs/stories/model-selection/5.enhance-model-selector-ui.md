# Story 5: Enhance Model Selector UI with Provider Grouping

## Status
Completed

## Story
**As a** end user,  
**I want** the ModelSelector to display models grouped by provider with icons, connection status, and additional model details,  
**so that** I can easily identify and select models from specific providers, improving the overall user experience in the chat interface.

## Acceptance Criteria
1. Models in dropdown are grouped by provider with headers showing icon, name, connection status indicator, and model count.
2. Each model row shows name, description, pricing, context length, and capabilities on hover or expand.
3. Selected model highlights within its provider group.
4. Provider groups collapse/expand if too many models.
5. Integration with admin selections: Only show selected models per provider.
6. Playwright e2e test: Open selector, expand a provider group, select a model, verify selection updates chat context.
7. Accessibility: ARIA roles for groups, keyboard navigation between groups and models.
8. Responsive design: Groups stack on mobile.

## Tasks / Subtasks
- [ ] Update ModelSelector.tsx to render provider groups from providerGroups state
  - [ ] Add group headers with icons, status dots, and counts
  - [ ] Display model details in list items with hover tooltips
  - [ ] Implement group collapse/expand functionality
- [ ] Integrate with filtered/searched models, preserving grouping
- [ ] Add ARIA attributes and keyboard handling for groups
- [ ] Write Playwright test for UI interactions in selector
  - [ ] Test group expansion, model selection, and verification in chat
- [ ] Style updates for better visual separation of groups

## Dev Notes
Relevant Source Tree:
- components/chat/ModelSelector.tsx: Extend existing providerGroups rendering
- components/ui/: Reuse icons and status components
- styles/: Add CSS for group headers and hover states

Testing Standards:
- Test file location: apps/web/tests/e2e/model-selector-ui.spec.ts
- Test standards: Use Playwright for e2e, focus on UI state changes
- Testing frameworks: Playwright with MCP server for frontend functionality
- Specific requirements: Run after UI enhancements, verify with mock providers and models

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-10 | 1.0 | Initial story creation | Product Owner |

## Dev Agent Record
### Agent Model Used
x-ai/grok-code-fast-1

### Debug Log References
- Enhanced ModelSelector with provider grouping and collapse/expand functionality
- Added Tooltip component integration for detailed model information
- Implemented ARIA attributes and keyboard navigation for accessibility
- Added responsive design for mobile devices
- Created comprehensive Playwright e2e tests

### Completion Notes List
- ✅ Added per-group collapse/expand functionality for groups with >5 models
- ✅ Enhanced hover tooltips using existing Tooltip component with detailed model info
- ✅ Improved ARIA attributes for provider groups with proper roles and labels
- ✅ Added keyboard navigation between groups and models (Arrow keys, Enter, Space)
- ✅ Implemented responsive design with mobile stacking and appropriate sizing
- ✅ Updated styles for better visual separation of groups on desktop
- ✅ Created comprehensive Playwright e2e test suite covering all acceptance criteria
- ✅ Maintained backward compatibility with existing admin selections integration
- ✅ All acceptance criteria from story have been implemented and tested

### File List
- `apps/web/src/components/chat/ModelSelector.tsx` - Enhanced with grouping, tooltips, accessibility, and responsive design
- `apps/web/tests/e2e/model-selector-ui.spec.ts` - New comprehensive e2e test suite
- `apps/web/src/components/ui/Tooltip.tsx` - Existing component used for model details

## QA Results
To be filled by QA agent