"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_ssr_src_lib_analyticsService_ts";
exports.ids = ["_ssr_src_lib_analyticsService_ts"];
exports.modules = {

/***/ "(ssr)/./src/lib/analyticsService.ts":
/*!*************************************!*\
  !*** ./src/lib/analyticsService.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AnalyticsService: () => (/* binding */ AnalyticsService),\n/* harmony export */   analyticsService: () => (/* binding */ analyticsService)\n/* harmony export */ });\n/* harmony import */ var _supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase */ \"(ssr)/./src/lib/supabase.ts\");\n\nclass AnalyticsService {\n    constructor(){\n        // Generate a session ID for this browser session\n        this.sessionId = this.getOrCreateSessionId();\n    }\n    getOrCreateSessionId() {\n        // Check if we're in a browser environment\n        if (true) {\n            // Server-side: generate a temporary session ID\n            return `server_session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n        }\n        let sessionId = localStorage.getItem('analytics_session_id');\n        if (!sessionId) {\n            sessionId = `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n            localStorage.setItem('analytics_session_id', sessionId);\n        }\n        return sessionId;\n    }\n    /**\n   * Track a user interaction event\n   */ async trackEvent(eventType, eventData = {}, userId) {\n        try {\n            const event = {\n                user_id: userId,\n                event_type: eventType,\n                event_data: eventData,\n                session_id: this.sessionId,\n                ip_address: null,\n                user_agent: navigator.userAgent\n            };\n            const { error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('analytics_events').insert(event);\n            if (error) {\n                console.warn('Failed to track analytics event:', error);\n            }\n        } catch (error) {\n            console.warn('Analytics tracking failed:', error);\n        }\n    }\n    /**\n   * Track model performance metrics\n   */ async trackModelPerformance(userId, conversationId, model, metrics) {\n        try {\n            const performance = {\n                user_id: userId,\n                conversation_id: conversationId,\n                model,\n                prompt_tokens: metrics.promptTokens,\n                completion_tokens: metrics.completionTokens,\n                total_tokens: metrics.totalTokens,\n                response_time_ms: metrics.responseTimeMs,\n                cost_cents: metrics.costCents,\n                success: metrics.success,\n                error_message: metrics.errorMessage\n            };\n            const { error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('model_performance').insert(performance);\n            if (error) {\n                console.warn('Failed to track model performance:', error);\n            }\n        } catch (error) {\n            console.warn('Model performance tracking failed:', error);\n        }\n    }\n    /**\n   * Update user engagement metrics\n   */ async updateUserEngagement(userId) {\n        try {\n            const today = new Date().toISOString().split('T')[0];\n            // First, try to update existing record\n            const { error: updateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('user_engagement').update({\n                last_activity: new Date().toISOString(),\n                updated_at: new Date().toISOString()\n            }).eq('user_id', userId).eq('date', today);\n            if (updateError) {\n                // If no existing record, create one\n                const engagement = {\n                    user_id: userId,\n                    date: today,\n                    messages_sent: 0,\n                    conversations_created: 0,\n                    session_duration_minutes: 0,\n                    models_used: [],\n                    features_used: [],\n                    last_activity: new Date().toISOString()\n                };\n                const { error: insertError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('user_engagement').insert(engagement);\n                if (insertError) {\n                    console.warn('Failed to create user engagement record:', insertError);\n                }\n            }\n        } catch (error) {\n            console.warn('User engagement update failed:', error);\n        }\n    }\n    /**\n   * Increment message count for user\n   */ async incrementMessageCount(userId) {\n        try {\n            const today = new Date().toISOString().split('T')[0];\n            // Get current value\n            const { data: currentData, error: fetchError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('user_engagement').select('messages_sent').eq('user_id', userId).eq('date', today).single();\n            const currentCount = currentData?.messages_sent || 0;\n            // Update or insert\n            const { error: upsertError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('user_engagement').upsert({\n                user_id: userId,\n                date: today,\n                messages_sent: currentCount + 1,\n                last_activity: new Date().toISOString(),\n                updated_at: new Date().toISOString()\n            }, {\n                onConflict: 'user_id,date'\n            });\n            if (upsertError) {\n                console.warn('Failed to increment message count:', upsertError);\n            }\n        } catch (error) {\n            console.warn('Message count increment failed:', error);\n        }\n    }\n    /**\n   * Increment conversation count for user\n   */ async incrementConversationCount(userId) {\n        try {\n            const today = new Date().toISOString().split('T')[0];\n            // Get current value\n            const { data: currentData, error: fetchError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('user_engagement').select('conversations_created').eq('user_id', userId).eq('date', today).single();\n            const currentCount = currentData?.conversations_created || 0;\n            // Update or insert\n            const { error: upsertError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('user_engagement').upsert({\n                user_id: userId,\n                date: today,\n                conversations_created: currentCount + 1,\n                last_activity: new Date().toISOString(),\n                updated_at: new Date().toISOString()\n            }, {\n                onConflict: 'user_id,date'\n            });\n            if (upsertError) {\n                console.warn('Failed to increment conversation count:', upsertError);\n            }\n        } catch (error) {\n            console.warn('Conversation count increment failed:', error);\n        }\n    }\n    /**\n   * Track model usage for user\n   */ async trackModelUsage(userId, model) {\n        try {\n            const today = new Date().toISOString().split('T')[0];\n            // Get current models_used array\n            const { data: currentData, error: fetchError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('user_engagement').select('models_used').eq('user_id', userId).eq('date', today).single();\n            if (fetchError && fetchError.code !== 'PGRST116') {\n                console.warn('Failed to fetch current model usage:', fetchError);\n                return;\n            }\n            const currentModels = currentData?.models_used || [];\n            const updatedModels = Array.from(new Set([\n                ...currentModels,\n                model\n            ]));\n            // Update or insert\n            const { error: upsertError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('user_engagement').upsert({\n                user_id: userId,\n                date: today,\n                models_used: updatedModels,\n                last_activity: new Date().toISOString(),\n                updated_at: new Date().toISOString()\n            }, {\n                onConflict: 'user_id,date'\n            });\n            if (upsertError) {\n                console.warn('Failed to track model usage:', upsertError);\n            }\n        } catch (error) {\n            console.warn('Model usage tracking failed:', error);\n        }\n    }\n    /**\n   * Track feature usage\n   */ async trackFeatureUsage(userId, feature) {\n        try {\n            const today = new Date().toISOString().split('T')[0];\n            // Get current features_used array\n            const { data: currentData, error: fetchError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('user_engagement').select('features_used').eq('user_id', userId).eq('date', today).single();\n            if (fetchError && fetchError.code !== 'PGRST116') {\n                console.warn('Failed to fetch current feature usage:', fetchError);\n                return;\n            }\n            const currentFeatures = currentData?.features_used || [];\n            const updatedFeatures = Array.from(new Set([\n                ...currentFeatures,\n                feature\n            ]));\n            // Update or insert\n            const { error: upsertError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('user_engagement').upsert({\n                user_id: userId,\n                date: today,\n                features_used: updatedFeatures,\n                last_activity: new Date().toISOString(),\n                updated_at: new Date().toISOString()\n            }, {\n                onConflict: 'user_id,date'\n            });\n            if (upsertError) {\n                console.warn('Failed to track feature usage:', upsertError);\n            }\n        } catch (error) {\n            console.warn('Feature usage tracking failed:', error);\n        }\n    }\n    /**\n   * Get analytics data for admin dashboard\n   */ async getAnalyticsData(dateRange) {\n        try {\n            // Get daily metrics\n            const { data: metrics, error: metricsError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('analytics_metrics').select('*').gte('date', dateRange.start).lte('date', dateRange.end).order('date', {\n                ascending: false\n            });\n            if (metricsError) throw metricsError;\n            // Get recent events\n            const { data: events, error: eventsError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('analytics_events').select(`\n          *,\n          users:user_id (\n            email,\n            full_name\n          )\n        `).gte('created_at', dateRange.start).lte('created_at', dateRange.end).order('created_at', {\n                ascending: false\n            }).limit(100);\n            if (eventsError) throw eventsError;\n            // Get model performance data\n            const { data: performance, error: performanceError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('model_performance').select('*').gte('created_at', dateRange.start).lte('created_at', dateRange.end).order('created_at', {\n                ascending: false\n            });\n            if (performanceError) throw performanceError;\n            // Get user engagement data\n            const { data: engagement, error: engagementError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from('user_engagement').select(`\n          *,\n          users:user_id (\n            email,\n            full_name\n          )\n        `).gte('date', dateRange.start).lte('date', dateRange.end).order('date', {\n                ascending: false\n            });\n            if (engagementError) throw engagementError;\n            return {\n                metrics: metrics || [],\n                events: events || [],\n                performance: performance || [],\n                engagement: engagement || []\n            };\n        } catch (error) {\n            console.error('Failed to fetch analytics data:', error);\n            throw error;\n        }\n    }\n}\nconst analyticsService = new AnalyticsService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9zcmMvbGliL2FuYWx5dGljc1NlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXFDO0FBTzlCLE1BQU1DO0lBR1gsYUFBYztRQUNaLGlEQUFpRDtRQUNqRCxJQUFJLENBQUNDLFNBQVMsR0FBRyxJQUFJLENBQUNDLG9CQUFvQjtJQUM1QztJQUVRQSx1QkFBK0I7UUFDckMsMENBQTBDO1FBQzFDLElBQUksSUFBNkIsRUFBRTtZQUNqQywrQ0FBK0M7WUFDL0MsT0FBTyxDQUFDLGVBQWUsRUFBRUMsS0FBS0MsR0FBRyxHQUFHLENBQUMsRUFBRUMsS0FBS0MsTUFBTSxHQUFHQyxRQUFRLENBQUMsSUFBSUMsTUFBTSxDQUFDLEdBQUcsSUFBSTtRQUNsRjtRQUVBLElBQUlQLFlBQVlRLGFBQWFDLE9BQU8sQ0FBQztRQUNyQyxJQUFJLENBQUNULFdBQVc7WUFDZEEsWUFBWSxDQUFDLFFBQVEsRUFBRUUsS0FBS0MsR0FBRyxHQUFHLENBQUMsRUFBRUMsS0FBS0MsTUFBTSxHQUFHQyxRQUFRLENBQUMsSUFBSUMsTUFBTSxDQUFDLEdBQUcsSUFBSTtZQUM5RUMsYUFBYUUsT0FBTyxDQUFDLHdCQUF3QlY7UUFDL0M7UUFDQSxPQUFPQTtJQUNUO0lBRUE7O0dBRUMsR0FDRCxNQUFNVyxXQUNKQyxTQUFpQixFQUNqQkMsWUFBaUMsQ0FBQyxDQUFDLEVBQ25DQyxNQUFlLEVBQ0E7UUFDZixJQUFJO1lBQ0YsTUFBTUMsUUFBd0I7Z0JBQzVCQyxTQUFTRjtnQkFDVEcsWUFBWUw7Z0JBQ1pNLFlBQVlMO2dCQUNaTSxZQUFZLElBQUksQ0FBQ25CLFNBQVM7Z0JBQzFCb0IsWUFBWTtnQkFDWkMsWUFBWUMsVUFBVUMsU0FBUztZQUNqQztZQUVBLE1BQU0sRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTTFCLCtDQUFRQSxDQUM3QjJCLElBQUksQ0FBQyxvQkFDTEMsTUFBTSxDQUFDWDtZQUVWLElBQUlTLE9BQU87Z0JBQ1RHLFFBQVFDLElBQUksQ0FBQyxvQ0FBb0NKO1lBQ25EO1FBQ0YsRUFBRSxPQUFPQSxPQUFPO1lBQ2RHLFFBQVFDLElBQUksQ0FBQyw4QkFBOEJKO1FBQzdDO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE1BQU1LLHNCQUNKZixNQUFjLEVBQ2RnQixjQUFzQixFQUN0QkMsS0FBYSxFQUNiQyxPQVFDLEVBQ2M7UUFDZixJQUFJO1lBQ0YsTUFBTUMsY0FBZ0M7Z0JBQ3BDakIsU0FBU0Y7Z0JBQ1RvQixpQkFBaUJKO2dCQUNqQkM7Z0JBQ0FJLGVBQWVILFFBQVFJLFlBQVk7Z0JBQ25DQyxtQkFBbUJMLFFBQVFNLGdCQUFnQjtnQkFDM0NDLGNBQWNQLFFBQVFRLFdBQVc7Z0JBQ2pDQyxrQkFBa0JULFFBQVFVLGNBQWM7Z0JBQ3hDQyxZQUFZWCxRQUFRWSxTQUFTO2dCQUM3QkMsU0FBU2IsUUFBUWEsT0FBTztnQkFDeEJDLGVBQWVkLFFBQVFlLFlBQVk7WUFDckM7WUFFQSxNQUFNLEVBQUV2QixLQUFLLEVBQUUsR0FBRyxNQUFNMUIsK0NBQVFBLENBQzdCMkIsSUFBSSxDQUFDLHFCQUNMQyxNQUFNLENBQUNPO1lBRVYsSUFBSVQsT0FBTztnQkFDVEcsUUFBUUMsSUFBSSxDQUFDLHNDQUFzQ0o7WUFDckQ7UUFDRixFQUFFLE9BQU9BLE9BQU87WUFDZEcsUUFBUUMsSUFBSSxDQUFDLHNDQUFzQ0o7UUFDckQ7SUFDRjtJQUVBOztHQUVDLEdBQ0QsTUFBTXdCLHFCQUFxQmxDLE1BQWMsRUFBaUI7UUFDeEQsSUFBSTtZQUNGLE1BQU1tQyxRQUFRLElBQUkvQyxPQUFPZ0QsV0FBVyxHQUFHQyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFFcEQsdUNBQXVDO1lBQ3ZDLE1BQU0sRUFBRTNCLE9BQU80QixXQUFXLEVBQUUsR0FBRyxNQUFNdEQsK0NBQVFBLENBQzFDMkIsSUFBSSxDQUFDLG1CQUNMNEIsTUFBTSxDQUFDO2dCQUNOQyxlQUFlLElBQUlwRCxPQUFPZ0QsV0FBVztnQkFDckNLLFlBQVksSUFBSXJELE9BQU9nRCxXQUFXO1lBQ3BDLEdBQ0NNLEVBQUUsQ0FBQyxXQUFXMUMsUUFDZDBDLEVBQUUsQ0FBQyxRQUFRUDtZQUVkLElBQUlHLGFBQWE7Z0JBQ2Ysb0NBQW9DO2dCQUNwQyxNQUFNSyxhQUE2QjtvQkFDakN6QyxTQUFTRjtvQkFDVDRDLE1BQU1UO29CQUNOVSxlQUFlO29CQUNmQyx1QkFBdUI7b0JBQ3ZCQywwQkFBMEI7b0JBQzFCQyxhQUFhLEVBQUU7b0JBQ2ZDLGVBQWUsRUFBRTtvQkFDakJULGVBQWUsSUFBSXBELE9BQU9nRCxXQUFXO2dCQUN2QztnQkFFQSxNQUFNLEVBQUUxQixPQUFPd0MsV0FBVyxFQUFFLEdBQUcsTUFBTWxFLCtDQUFRQSxDQUMxQzJCLElBQUksQ0FBQyxtQkFDTEMsTUFBTSxDQUFDK0I7Z0JBRVYsSUFBSU8sYUFBYTtvQkFDZnJDLFFBQVFDLElBQUksQ0FBQyw0Q0FBNENvQztnQkFDM0Q7WUFDRjtRQUNGLEVBQUUsT0FBT3hDLE9BQU87WUFDZEcsUUFBUUMsSUFBSSxDQUFDLGtDQUFrQ0o7UUFDakQ7SUFDRjtJQUVBOztHQUVDLEdBQ0QsTUFBTXlDLHNCQUFzQm5ELE1BQWMsRUFBaUI7UUFDekQsSUFBSTtZQUNGLE1BQU1tQyxRQUFRLElBQUkvQyxPQUFPZ0QsV0FBVyxHQUFHQyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFFcEQsb0JBQW9CO1lBQ3BCLE1BQU0sRUFBRWUsTUFBTUMsV0FBVyxFQUFFM0MsT0FBTzRDLFVBQVUsRUFBRSxHQUFHLE1BQU10RSwrQ0FBUUEsQ0FDNUQyQixJQUFJLENBQUMsbUJBQ0w0QyxNQUFNLENBQUMsaUJBQ1BiLEVBQUUsQ0FBQyxXQUFXMUMsUUFDZDBDLEVBQUUsQ0FBQyxRQUFRUCxPQUNYcUIsTUFBTTtZQUVULE1BQU1DLGVBQWVKLGFBQWFSLGlCQUFpQjtZQUVuRCxtQkFBbUI7WUFDbkIsTUFBTSxFQUFFbkMsT0FBT2dELFdBQVcsRUFBRSxHQUFHLE1BQU0xRSwrQ0FBUUEsQ0FDMUMyQixJQUFJLENBQUMsbUJBQ0xnRCxNQUFNLENBQUM7Z0JBQ056RCxTQUFTRjtnQkFDVDRDLE1BQU1UO2dCQUNOVSxlQUFlWSxlQUFlO2dCQUM5QmpCLGVBQWUsSUFBSXBELE9BQU9nRCxXQUFXO2dCQUNyQ0ssWUFBWSxJQUFJckQsT0FBT2dELFdBQVc7WUFDcEMsR0FBRztnQkFDRHdCLFlBQVk7WUFDZDtZQUVGLElBQUlGLGFBQWE7Z0JBQ2Y3QyxRQUFRQyxJQUFJLENBQUMsc0NBQXNDNEM7WUFDckQ7UUFDRixFQUFFLE9BQU9oRCxPQUFPO1lBQ2RHLFFBQVFDLElBQUksQ0FBQyxtQ0FBbUNKO1FBQ2xEO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE1BQU1tRCwyQkFBMkI3RCxNQUFjLEVBQWlCO1FBQzlELElBQUk7WUFDRixNQUFNbUMsUUFBUSxJQUFJL0MsT0FBT2dELFdBQVcsR0FBR0MsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBRXBELG9CQUFvQjtZQUNwQixNQUFNLEVBQUVlLE1BQU1DLFdBQVcsRUFBRTNDLE9BQU80QyxVQUFVLEVBQUUsR0FBRyxNQUFNdEUsK0NBQVFBLENBQzVEMkIsSUFBSSxDQUFDLG1CQUNMNEMsTUFBTSxDQUFDLHlCQUNQYixFQUFFLENBQUMsV0FBVzFDLFFBQ2QwQyxFQUFFLENBQUMsUUFBUVAsT0FDWHFCLE1BQU07WUFFVCxNQUFNQyxlQUFlSixhQUFhUCx5QkFBeUI7WUFFM0QsbUJBQW1CO1lBQ25CLE1BQU0sRUFBRXBDLE9BQU9nRCxXQUFXLEVBQUUsR0FBRyxNQUFNMUUsK0NBQVFBLENBQzFDMkIsSUFBSSxDQUFDLG1CQUNMZ0QsTUFBTSxDQUFDO2dCQUNOekQsU0FBU0Y7Z0JBQ1Q0QyxNQUFNVDtnQkFDTlcsdUJBQXVCVyxlQUFlO2dCQUN0Q2pCLGVBQWUsSUFBSXBELE9BQU9nRCxXQUFXO2dCQUNyQ0ssWUFBWSxJQUFJckQsT0FBT2dELFdBQVc7WUFDcEMsR0FBRztnQkFDRHdCLFlBQVk7WUFDZDtZQUVGLElBQUlGLGFBQWE7Z0JBQ2Y3QyxRQUFRQyxJQUFJLENBQUMsMkNBQTJDNEM7WUFDMUQ7UUFDRixFQUFFLE9BQU9oRCxPQUFPO1lBQ2RHLFFBQVFDLElBQUksQ0FBQyx3Q0FBd0NKO1FBQ3ZEO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE1BQU1vRCxnQkFBZ0I5RCxNQUFjLEVBQUVpQixLQUFhLEVBQWlCO1FBQ2xFLElBQUk7WUFDRixNQUFNa0IsUUFBUSxJQUFJL0MsT0FBT2dELFdBQVcsR0FBR0MsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBRXBELGdDQUFnQztZQUNoQyxNQUFNLEVBQUVlLE1BQU1DLFdBQVcsRUFBRTNDLE9BQU80QyxVQUFVLEVBQUUsR0FBRyxNQUFNdEUsK0NBQVFBLENBQzVEMkIsSUFBSSxDQUFDLG1CQUNMNEMsTUFBTSxDQUFDLGVBQ1BiLEVBQUUsQ0FBQyxXQUFXMUMsUUFDZDBDLEVBQUUsQ0FBQyxRQUFRUCxPQUNYcUIsTUFBTTtZQUVULElBQUlGLGNBQWNBLFdBQVdTLElBQUksS0FBSyxZQUFZO2dCQUNoRGxELFFBQVFDLElBQUksQ0FBQyx3Q0FBd0N3QztnQkFDckQ7WUFDRjtZQUVBLE1BQU1VLGdCQUFnQlgsYUFBYUwsZUFBZSxFQUFFO1lBQ3BELE1BQU1pQixnQkFBZ0JDLE1BQU12RCxJQUFJLENBQUMsSUFBSXdELElBQUk7bUJBQUlIO2dCQUFlL0M7YUFBTTtZQUVsRSxtQkFBbUI7WUFDbkIsTUFBTSxFQUFFUCxPQUFPZ0QsV0FBVyxFQUFFLEdBQUcsTUFBTTFFLCtDQUFRQSxDQUMxQzJCLElBQUksQ0FBQyxtQkFDTGdELE1BQU0sQ0FBQztnQkFDTnpELFNBQVNGO2dCQUNUNEMsTUFBTVQ7Z0JBQ05hLGFBQWFpQjtnQkFDYnpCLGVBQWUsSUFBSXBELE9BQU9nRCxXQUFXO2dCQUNyQ0ssWUFBWSxJQUFJckQsT0FBT2dELFdBQVc7WUFDcEMsR0FBRztnQkFDRHdCLFlBQVk7WUFDZDtZQUVGLElBQUlGLGFBQWE7Z0JBQ2Y3QyxRQUFRQyxJQUFJLENBQUMsZ0NBQWdDNEM7WUFDL0M7UUFDRixFQUFFLE9BQU9oRCxPQUFPO1lBQ2RHLFFBQVFDLElBQUksQ0FBQyxnQ0FBZ0NKO1FBQy9DO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE1BQU0wRCxrQkFBa0JwRSxNQUFjLEVBQUVxRSxPQUFlLEVBQWlCO1FBQ3RFLElBQUk7WUFDRixNQUFNbEMsUUFBUSxJQUFJL0MsT0FBT2dELFdBQVcsR0FBR0MsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBRXBELGtDQUFrQztZQUNsQyxNQUFNLEVBQUVlLE1BQU1DLFdBQVcsRUFBRTNDLE9BQU80QyxVQUFVLEVBQUUsR0FBRyxNQUFNdEUsK0NBQVFBLENBQzVEMkIsSUFBSSxDQUFDLG1CQUNMNEMsTUFBTSxDQUFDLGlCQUNQYixFQUFFLENBQUMsV0FBVzFDLFFBQ2QwQyxFQUFFLENBQUMsUUFBUVAsT0FDWHFCLE1BQU07WUFFVCxJQUFJRixjQUFjQSxXQUFXUyxJQUFJLEtBQUssWUFBWTtnQkFDaERsRCxRQUFRQyxJQUFJLENBQUMsMENBQTBDd0M7Z0JBQ3ZEO1lBQ0Y7WUFFQSxNQUFNZ0Isa0JBQWtCakIsYUFBYUosaUJBQWlCLEVBQUU7WUFDeEQsTUFBTXNCLGtCQUFrQkwsTUFBTXZELElBQUksQ0FBQyxJQUFJd0QsSUFBSTttQkFBSUc7Z0JBQWlCRDthQUFRO1lBRXhFLG1CQUFtQjtZQUNuQixNQUFNLEVBQUUzRCxPQUFPZ0QsV0FBVyxFQUFFLEdBQUcsTUFBTTFFLCtDQUFRQSxDQUMxQzJCLElBQUksQ0FBQyxtQkFDTGdELE1BQU0sQ0FBQztnQkFDTnpELFNBQVNGO2dCQUNUNEMsTUFBTVQ7Z0JBQ05jLGVBQWVzQjtnQkFDZi9CLGVBQWUsSUFBSXBELE9BQU9nRCxXQUFXO2dCQUNyQ0ssWUFBWSxJQUFJckQsT0FBT2dELFdBQVc7WUFDcEMsR0FBRztnQkFDRHdCLFlBQVk7WUFDZDtZQUVGLElBQUlGLGFBQWE7Z0JBQ2Y3QyxRQUFRQyxJQUFJLENBQUMsa0NBQWtDNEM7WUFDakQ7UUFDRixFQUFFLE9BQU9oRCxPQUFPO1lBQ2RHLFFBQVFDLElBQUksQ0FBQyxrQ0FBa0NKO1FBQ2pEO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE1BQU04RCxpQkFBaUJDLFNBQXlDLEVBQUU7UUFDaEUsSUFBSTtZQUNGLG9CQUFvQjtZQUNwQixNQUFNLEVBQUVyQixNQUFNbEMsT0FBTyxFQUFFUixPQUFPZ0UsWUFBWSxFQUFFLEdBQUcsTUFBTTFGLCtDQUFRQSxDQUMxRDJCLElBQUksQ0FBQyxxQkFDTDRDLE1BQU0sQ0FBQyxLQUNQb0IsR0FBRyxDQUFDLFFBQVFGLFVBQVVHLEtBQUssRUFDM0JDLEdBQUcsQ0FBQyxRQUFRSixVQUFVSyxHQUFHLEVBQ3pCQyxLQUFLLENBQUMsUUFBUTtnQkFBRUMsV0FBVztZQUFNO1lBRXBDLElBQUlOLGNBQWMsTUFBTUE7WUFFeEIsb0JBQW9CO1lBQ3BCLE1BQU0sRUFBRXRCLE1BQU02QixNQUFNLEVBQUV2RSxPQUFPd0UsV0FBVyxFQUFFLEdBQUcsTUFBTWxHLCtDQUFRQSxDQUN4RDJCLElBQUksQ0FBQyxvQkFDTDRDLE1BQU0sQ0FBQyxDQUFDOzs7Ozs7UUFNVCxDQUFDLEVBQ0FvQixHQUFHLENBQUMsY0FBY0YsVUFBVUcsS0FBSyxFQUNqQ0MsR0FBRyxDQUFDLGNBQWNKLFVBQVVLLEdBQUcsRUFDL0JDLEtBQUssQ0FBQyxjQUFjO2dCQUFFQyxXQUFXO1lBQU0sR0FDdkNHLEtBQUssQ0FBQztZQUVULElBQUlELGFBQWEsTUFBTUE7WUFFdkIsNkJBQTZCO1lBQzdCLE1BQU0sRUFBRTlCLE1BQU1qQyxXQUFXLEVBQUVULE9BQU8wRSxnQkFBZ0IsRUFBRSxHQUFHLE1BQU1wRywrQ0FBUUEsQ0FDbEUyQixJQUFJLENBQUMscUJBQ0w0QyxNQUFNLENBQUMsS0FDUG9CLEdBQUcsQ0FBQyxjQUFjRixVQUFVRyxLQUFLLEVBQ2pDQyxHQUFHLENBQUMsY0FBY0osVUFBVUssR0FBRyxFQUMvQkMsS0FBSyxDQUFDLGNBQWM7Z0JBQUVDLFdBQVc7WUFBTTtZQUUxQyxJQUFJSSxrQkFBa0IsTUFBTUE7WUFFNUIsMkJBQTJCO1lBQzNCLE1BQU0sRUFBRWhDLE1BQU1ULFVBQVUsRUFBRWpDLE9BQU8yRSxlQUFlLEVBQUUsR0FBRyxNQUFNckcsK0NBQVFBLENBQ2hFMkIsSUFBSSxDQUFDLG1CQUNMNEMsTUFBTSxDQUFDLENBQUM7Ozs7OztRQU1ULENBQUMsRUFDQW9CLEdBQUcsQ0FBQyxRQUFRRixVQUFVRyxLQUFLLEVBQzNCQyxHQUFHLENBQUMsUUFBUUosVUFBVUssR0FBRyxFQUN6QkMsS0FBSyxDQUFDLFFBQVE7Z0JBQUVDLFdBQVc7WUFBTTtZQUVwQyxJQUFJSyxpQkFBaUIsTUFBTUE7WUFFM0IsT0FBTztnQkFDTG5FLFNBQVNBLFdBQVcsRUFBRTtnQkFDdEIrRCxRQUFRQSxVQUFVLEVBQUU7Z0JBQ3BCOUQsYUFBYUEsZUFBZSxFQUFFO2dCQUM5QndCLFlBQVlBLGNBQWMsRUFBRTtZQUM5QjtRQUNGLEVBQUUsT0FBT2pDLE9BQU87WUFDZEcsUUFBUUgsS0FBSyxDQUFDLG1DQUFtQ0E7WUFDakQsTUFBTUE7UUFDUjtJQUNGO0FBQ0Y7QUFFTyxNQUFNNEUsbUJBQW1CLElBQUlyRyxtQkFBa0IiLCJzb3VyY2VzIjpbIi9ob21lL2JhdXN0aW4yNy9EZXYvbm90ZWJvb2svYXBwcy93ZWIvc3JjL2xpYi9hbmFseXRpY3NTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSAnLi9zdXBhYmFzZSdcbmltcG9ydCB0eXBlIHsgRGF0YWJhc2UgfSBmcm9tICcuLi90eXBlcy9kYXRhYmFzZSdcblxudHlwZSBBbmFseXRpY3NFdmVudCA9IERhdGFiYXNlWydwdWJsaWMnXVsnVGFibGVzJ11bJ2FuYWx5dGljc19ldmVudHMnXVsnSW5zZXJ0J11cbnR5cGUgTW9kZWxQZXJmb3JtYW5jZSA9IERhdGFiYXNlWydwdWJsaWMnXVsnVGFibGVzJ11bJ21vZGVsX3BlcmZvcm1hbmNlJ11bJ0luc2VydCddXG50eXBlIFVzZXJFbmdhZ2VtZW50ID0gRGF0YWJhc2VbJ3B1YmxpYyddWydUYWJsZXMnXVsndXNlcl9lbmdhZ2VtZW50J11bJ0luc2VydCddXG5cbmV4cG9ydCBjbGFzcyBBbmFseXRpY3NTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBzZXNzaW9uSWQ6IHN0cmluZ1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIC8vIEdlbmVyYXRlIGEgc2Vzc2lvbiBJRCBmb3IgdGhpcyBicm93c2VyIHNlc3Npb25cbiAgICB0aGlzLnNlc3Npb25JZCA9IHRoaXMuZ2V0T3JDcmVhdGVTZXNzaW9uSWQoKVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRPckNyZWF0ZVNlc3Npb25JZCgpOiBzdHJpbmcge1xuICAgIC8vIENoZWNrIGlmIHdlJ3JlIGluIGEgYnJvd3NlciBlbnZpcm9ubWVudFxuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgLy8gU2VydmVyLXNpZGU6IGdlbmVyYXRlIGEgdGVtcG9yYXJ5IHNlc3Npb24gSURcbiAgICAgIHJldHVybiBgc2VydmVyX3Nlc3Npb25fJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gXG4gICAgfVxuICAgIFxuICAgIGxldCBzZXNzaW9uSWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYW5hbHl0aWNzX3Nlc3Npb25faWQnKVxuICAgIGlmICghc2Vzc2lvbklkKSB7XG4gICAgICBzZXNzaW9uSWQgPSBgc2Vzc2lvbl8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWBcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhbmFseXRpY3Nfc2Vzc2lvbl9pZCcsIHNlc3Npb25JZClcbiAgICB9XG4gICAgcmV0dXJuIHNlc3Npb25JZFxuICB9XG5cbiAgLyoqXG4gICAqIFRyYWNrIGEgdXNlciBpbnRlcmFjdGlvbiBldmVudFxuICAgKi9cbiAgYXN5bmMgdHJhY2tFdmVudChcbiAgICBldmVudFR5cGU6IHN0cmluZyxcbiAgICBldmVudERhdGE6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fSxcbiAgICB1c2VySWQ/OiBzdHJpbmdcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGV2ZW50OiBBbmFseXRpY3NFdmVudCA9IHtcbiAgICAgICAgdXNlcl9pZDogdXNlcklkLFxuICAgICAgICBldmVudF90eXBlOiBldmVudFR5cGUsXG4gICAgICAgIGV2ZW50X2RhdGE6IGV2ZW50RGF0YSxcbiAgICAgICAgc2Vzc2lvbl9pZDogdGhpcy5zZXNzaW9uSWQsXG4gICAgICAgIGlwX2FkZHJlc3M6IG51bGwsIC8vIFdpbGwgYmUgc2V0IGJ5IHNlcnZlciBpZiBuZWVkZWRcbiAgICAgICAgdXNlcl9hZ2VudDogbmF2aWdhdG9yLnVzZXJBZ2VudFxuICAgICAgfVxuXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYW5hbHl0aWNzX2V2ZW50cycpXG4gICAgICAgIC5pbnNlcnQoZXZlbnQpXG5cbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byB0cmFjayBhbmFseXRpY3MgZXZlbnQ6JywgZXJyb3IpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignQW5hbHl0aWNzIHRyYWNraW5nIGZhaWxlZDonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVHJhY2sgbW9kZWwgcGVyZm9ybWFuY2UgbWV0cmljc1xuICAgKi9cbiAgYXN5bmMgdHJhY2tNb2RlbFBlcmZvcm1hbmNlKFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIGNvbnZlcnNhdGlvbklkOiBzdHJpbmcsXG4gICAgbW9kZWw6IHN0cmluZyxcbiAgICBtZXRyaWNzOiB7XG4gICAgICBwcm9tcHRUb2tlbnM/OiBudW1iZXJcbiAgICAgIGNvbXBsZXRpb25Ub2tlbnM/OiBudW1iZXJcbiAgICAgIHRvdGFsVG9rZW5zPzogbnVtYmVyXG4gICAgICByZXNwb25zZVRpbWVNcz86IG51bWJlclxuICAgICAgY29zdENlbnRzPzogbnVtYmVyXG4gICAgICBzdWNjZXNzOiBib29sZWFuXG4gICAgICBlcnJvck1lc3NhZ2U/OiBzdHJpbmdcbiAgICB9XG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBwZXJmb3JtYW5jZTogTW9kZWxQZXJmb3JtYW5jZSA9IHtcbiAgICAgICAgdXNlcl9pZDogdXNlcklkLFxuICAgICAgICBjb252ZXJzYXRpb25faWQ6IGNvbnZlcnNhdGlvbklkLFxuICAgICAgICBtb2RlbCxcbiAgICAgICAgcHJvbXB0X3Rva2VuczogbWV0cmljcy5wcm9tcHRUb2tlbnMsXG4gICAgICAgIGNvbXBsZXRpb25fdG9rZW5zOiBtZXRyaWNzLmNvbXBsZXRpb25Ub2tlbnMsXG4gICAgICAgIHRvdGFsX3Rva2VuczogbWV0cmljcy50b3RhbFRva2VucyxcbiAgICAgICAgcmVzcG9uc2VfdGltZV9tczogbWV0cmljcy5yZXNwb25zZVRpbWVNcyxcbiAgICAgICAgY29zdF9jZW50czogbWV0cmljcy5jb3N0Q2VudHMsXG4gICAgICAgIHN1Y2Nlc3M6IG1ldHJpY3Muc3VjY2VzcyxcbiAgICAgICAgZXJyb3JfbWVzc2FnZTogbWV0cmljcy5lcnJvck1lc3NhZ2VcbiAgICAgIH1cblxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ21vZGVsX3BlcmZvcm1hbmNlJylcbiAgICAgICAgLmluc2VydChwZXJmb3JtYW5jZSlcblxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHRyYWNrIG1vZGVsIHBlcmZvcm1hbmNlOicsIGVycm9yKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ01vZGVsIHBlcmZvcm1hbmNlIHRyYWNraW5nIGZhaWxlZDonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHVzZXIgZW5nYWdlbWVudCBtZXRyaWNzXG4gICAqL1xuICBhc3luYyB1cGRhdGVVc2VyRW5nYWdlbWVudCh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdXG5cbiAgICAgIC8vIEZpcnN0LCB0cnkgdG8gdXBkYXRlIGV4aXN0aW5nIHJlY29yZFxuICAgICAgY29uc3QgeyBlcnJvcjogdXBkYXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCd1c2VyX2VuZ2FnZW1lbnQnKVxuICAgICAgICAudXBkYXRlKHtcbiAgICAgICAgICBsYXN0X2FjdGl2aXR5OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH0pXG4gICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcbiAgICAgICAgLmVxKCdkYXRlJywgdG9kYXkpXG5cbiAgICAgIGlmICh1cGRhdGVFcnJvcikge1xuICAgICAgICAvLyBJZiBubyBleGlzdGluZyByZWNvcmQsIGNyZWF0ZSBvbmVcbiAgICAgICAgY29uc3QgZW5nYWdlbWVudDogVXNlckVuZ2FnZW1lbnQgPSB7XG4gICAgICAgICAgdXNlcl9pZDogdXNlcklkLFxuICAgICAgICAgIGRhdGU6IHRvZGF5LFxuICAgICAgICAgIG1lc3NhZ2VzX3NlbnQ6IDAsXG4gICAgICAgICAgY29udmVyc2F0aW9uc19jcmVhdGVkOiAwLFxuICAgICAgICAgIHNlc3Npb25fZHVyYXRpb25fbWludXRlczogMCxcbiAgICAgICAgICBtb2RlbHNfdXNlZDogW10sXG4gICAgICAgICAgZmVhdHVyZXNfdXNlZDogW10sXG4gICAgICAgICAgbGFzdF9hY3Rpdml0eTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7IGVycm9yOiBpbnNlcnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAuZnJvbSgndXNlcl9lbmdhZ2VtZW50JylcbiAgICAgICAgICAuaW5zZXJ0KGVuZ2FnZW1lbnQpXG5cbiAgICAgICAgaWYgKGluc2VydEVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gY3JlYXRlIHVzZXIgZW5nYWdlbWVudCByZWNvcmQ6JywgaW5zZXJ0RXJyb3IpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdVc2VyIGVuZ2FnZW1lbnQgdXBkYXRlIGZhaWxlZDonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSW5jcmVtZW50IG1lc3NhZ2UgY291bnQgZm9yIHVzZXJcbiAgICovXG4gIGFzeW5jIGluY3JlbWVudE1lc3NhZ2VDb3VudCh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdXG5cbiAgICAgIC8vIEdldCBjdXJyZW50IHZhbHVlXG4gICAgICBjb25zdCB7IGRhdGE6IGN1cnJlbnREYXRhLCBlcnJvcjogZmV0Y2hFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3VzZXJfZW5nYWdlbWVudCcpXG4gICAgICAgIC5zZWxlY3QoJ21lc3NhZ2VzX3NlbnQnKVxuICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG4gICAgICAgIC5lcSgnZGF0ZScsIHRvZGF5KVxuICAgICAgICAuc2luZ2xlKClcblxuICAgICAgY29uc3QgY3VycmVudENvdW50ID0gY3VycmVudERhdGE/Lm1lc3NhZ2VzX3NlbnQgfHwgMFxuXG4gICAgICAvLyBVcGRhdGUgb3IgaW5zZXJ0XG4gICAgICBjb25zdCB7IGVycm9yOiB1cHNlcnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3VzZXJfZW5nYWdlbWVudCcpXG4gICAgICAgIC51cHNlcnQoe1xuICAgICAgICAgIHVzZXJfaWQ6IHVzZXJJZCxcbiAgICAgICAgICBkYXRlOiB0b2RheSxcbiAgICAgICAgICBtZXNzYWdlc19zZW50OiBjdXJyZW50Q291bnQgKyAxLFxuICAgICAgICAgIGxhc3RfYWN0aXZpdHk6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfSwge1xuICAgICAgICAgIG9uQ29uZmxpY3Q6ICd1c2VyX2lkLGRhdGUnXG4gICAgICAgIH0pXG5cbiAgICAgIGlmICh1cHNlcnRFcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBpbmNyZW1lbnQgbWVzc2FnZSBjb3VudDonLCB1cHNlcnRFcnJvcilcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdNZXNzYWdlIGNvdW50IGluY3JlbWVudCBmYWlsZWQ6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEluY3JlbWVudCBjb252ZXJzYXRpb24gY291bnQgZm9yIHVzZXJcbiAgICovXG4gIGFzeW5jIGluY3JlbWVudENvbnZlcnNhdGlvbkNvdW50KHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF1cblxuICAgICAgLy8gR2V0IGN1cnJlbnQgdmFsdWVcbiAgICAgIGNvbnN0IHsgZGF0YTogY3VycmVudERhdGEsIGVycm9yOiBmZXRjaEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgndXNlcl9lbmdhZ2VtZW50JylcbiAgICAgICAgLnNlbGVjdCgnY29udmVyc2F0aW9uc19jcmVhdGVkJylcbiAgICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxuICAgICAgICAuZXEoJ2RhdGUnLCB0b2RheSlcbiAgICAgICAgLnNpbmdsZSgpXG5cbiAgICAgIGNvbnN0IGN1cnJlbnRDb3VudCA9IGN1cnJlbnREYXRhPy5jb252ZXJzYXRpb25zX2NyZWF0ZWQgfHwgMFxuXG4gICAgICAvLyBVcGRhdGUgb3IgaW5zZXJ0XG4gICAgICBjb25zdCB7IGVycm9yOiB1cHNlcnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3VzZXJfZW5nYWdlbWVudCcpXG4gICAgICAgIC51cHNlcnQoe1xuICAgICAgICAgIHVzZXJfaWQ6IHVzZXJJZCxcbiAgICAgICAgICBkYXRlOiB0b2RheSxcbiAgICAgICAgICBjb252ZXJzYXRpb25zX2NyZWF0ZWQ6IGN1cnJlbnRDb3VudCArIDEsXG4gICAgICAgICAgbGFzdF9hY3Rpdml0eTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9LCB7XG4gICAgICAgICAgb25Db25mbGljdDogJ3VzZXJfaWQsZGF0ZSdcbiAgICAgICAgfSlcblxuICAgICAgaWYgKHVwc2VydEVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGluY3JlbWVudCBjb252ZXJzYXRpb24gY291bnQ6JywgdXBzZXJ0RXJyb3IpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignQ29udmVyc2F0aW9uIGNvdW50IGluY3JlbWVudCBmYWlsZWQ6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRyYWNrIG1vZGVsIHVzYWdlIGZvciB1c2VyXG4gICAqL1xuICBhc3luYyB0cmFja01vZGVsVXNhZ2UodXNlcklkOiBzdHJpbmcsIG1vZGVsOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXVxuXG4gICAgICAvLyBHZXQgY3VycmVudCBtb2RlbHNfdXNlZCBhcnJheVxuICAgICAgY29uc3QgeyBkYXRhOiBjdXJyZW50RGF0YSwgZXJyb3I6IGZldGNoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCd1c2VyX2VuZ2FnZW1lbnQnKVxuICAgICAgICAuc2VsZWN0KCdtb2RlbHNfdXNlZCcpXG4gICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcbiAgICAgICAgLmVxKCdkYXRlJywgdG9kYXkpXG4gICAgICAgIC5zaW5nbGUoKVxuXG4gICAgICBpZiAoZmV0Y2hFcnJvciAmJiBmZXRjaEVycm9yLmNvZGUgIT09ICdQR1JTVDExNicpIHsgLy8gUEdSU1QxMTYgPSBubyByb3dzXG4gICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGZldGNoIGN1cnJlbnQgbW9kZWwgdXNhZ2U6JywgZmV0Y2hFcnJvcilcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGN1cnJlbnRNb2RlbHMgPSBjdXJyZW50RGF0YT8ubW9kZWxzX3VzZWQgfHwgW11cbiAgICAgIGNvbnN0IHVwZGF0ZWRNb2RlbHMgPSBBcnJheS5mcm9tKG5ldyBTZXQoWy4uLmN1cnJlbnRNb2RlbHMsIG1vZGVsXSkpXG5cbiAgICAgIC8vIFVwZGF0ZSBvciBpbnNlcnRcbiAgICAgIGNvbnN0IHsgZXJyb3I6IHVwc2VydEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgndXNlcl9lbmdhZ2VtZW50JylcbiAgICAgICAgLnVwc2VydCh7XG4gICAgICAgICAgdXNlcl9pZDogdXNlcklkLFxuICAgICAgICAgIGRhdGU6IHRvZGF5LFxuICAgICAgICAgIG1vZGVsc191c2VkOiB1cGRhdGVkTW9kZWxzLFxuICAgICAgICAgIGxhc3RfYWN0aXZpdHk6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfSwge1xuICAgICAgICAgIG9uQ29uZmxpY3Q6ICd1c2VyX2lkLGRhdGUnXG4gICAgICAgIH0pXG5cbiAgICAgIGlmICh1cHNlcnRFcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byB0cmFjayBtb2RlbCB1c2FnZTonLCB1cHNlcnRFcnJvcilcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdNb2RlbCB1c2FnZSB0cmFja2luZyBmYWlsZWQ6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRyYWNrIGZlYXR1cmUgdXNhZ2VcbiAgICovXG4gIGFzeW5jIHRyYWNrRmVhdHVyZVVzYWdlKHVzZXJJZDogc3RyaW5nLCBmZWF0dXJlOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXVxuXG4gICAgICAvLyBHZXQgY3VycmVudCBmZWF0dXJlc191c2VkIGFycmF5XG4gICAgICBjb25zdCB7IGRhdGE6IGN1cnJlbnREYXRhLCBlcnJvcjogZmV0Y2hFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3VzZXJfZW5nYWdlbWVudCcpXG4gICAgICAgIC5zZWxlY3QoJ2ZlYXR1cmVzX3VzZWQnKVxuICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG4gICAgICAgIC5lcSgnZGF0ZScsIHRvZGF5KVxuICAgICAgICAuc2luZ2xlKClcblxuICAgICAgaWYgKGZldGNoRXJyb3IgJiYgZmV0Y2hFcnJvci5jb2RlICE9PSAnUEdSU1QxMTYnKSB7IC8vIFBHUlNUMTE2ID0gbm8gcm93c1xuICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBmZXRjaCBjdXJyZW50IGZlYXR1cmUgdXNhZ2U6JywgZmV0Y2hFcnJvcilcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGN1cnJlbnRGZWF0dXJlcyA9IGN1cnJlbnREYXRhPy5mZWF0dXJlc191c2VkIHx8IFtdXG4gICAgICBjb25zdCB1cGRhdGVkRmVhdHVyZXMgPSBBcnJheS5mcm9tKG5ldyBTZXQoWy4uLmN1cnJlbnRGZWF0dXJlcywgZmVhdHVyZV0pKVxuXG4gICAgICAvLyBVcGRhdGUgb3IgaW5zZXJ0XG4gICAgICBjb25zdCB7IGVycm9yOiB1cHNlcnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3VzZXJfZW5nYWdlbWVudCcpXG4gICAgICAgIC51cHNlcnQoe1xuICAgICAgICAgIHVzZXJfaWQ6IHVzZXJJZCxcbiAgICAgICAgICBkYXRlOiB0b2RheSxcbiAgICAgICAgICBmZWF0dXJlc191c2VkOiB1cGRhdGVkRmVhdHVyZXMsXG4gICAgICAgICAgbGFzdF9hY3Rpdml0eTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9LCB7XG4gICAgICAgICAgb25Db25mbGljdDogJ3VzZXJfaWQsZGF0ZSdcbiAgICAgICAgfSlcblxuICAgICAgaWYgKHVwc2VydEVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHRyYWNrIGZlYXR1cmUgdXNhZ2U6JywgdXBzZXJ0RXJyb3IpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignRmVhdHVyZSB1c2FnZSB0cmFja2luZyBmYWlsZWQ6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbmFseXRpY3MgZGF0YSBmb3IgYWRtaW4gZGFzaGJvYXJkXG4gICAqL1xuICBhc3luYyBnZXRBbmFseXRpY3NEYXRhKGRhdGVSYW5nZTogeyBzdGFydDogc3RyaW5nOyBlbmQ6IHN0cmluZyB9KSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEdldCBkYWlseSBtZXRyaWNzXG4gICAgICBjb25zdCB7IGRhdGE6IG1ldHJpY3MsIGVycm9yOiBtZXRyaWNzRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdhbmFseXRpY3NfbWV0cmljcycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAuZ3RlKCdkYXRlJywgZGF0ZVJhbmdlLnN0YXJ0KVxuICAgICAgICAubHRlKCdkYXRlJywgZGF0ZVJhbmdlLmVuZClcbiAgICAgICAgLm9yZGVyKCdkYXRlJywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG5cbiAgICAgIGlmIChtZXRyaWNzRXJyb3IpIHRocm93IG1ldHJpY3NFcnJvclxuXG4gICAgICAvLyBHZXQgcmVjZW50IGV2ZW50c1xuICAgICAgY29uc3QgeyBkYXRhOiBldmVudHMsIGVycm9yOiBldmVudHNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2FuYWx5dGljc19ldmVudHMnKVxuICAgICAgICAuc2VsZWN0KGBcbiAgICAgICAgICAqLFxuICAgICAgICAgIHVzZXJzOnVzZXJfaWQgKFxuICAgICAgICAgICAgZW1haWwsXG4gICAgICAgICAgICBmdWxsX25hbWVcbiAgICAgICAgICApXG4gICAgICAgIGApXG4gICAgICAgIC5ndGUoJ2NyZWF0ZWRfYXQnLCBkYXRlUmFuZ2Uuc3RhcnQpXG4gICAgICAgIC5sdGUoJ2NyZWF0ZWRfYXQnLCBkYXRlUmFuZ2UuZW5kKVxuICAgICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAgICAgLmxpbWl0KDEwMClcblxuICAgICAgaWYgKGV2ZW50c0Vycm9yKSB0aHJvdyBldmVudHNFcnJvclxuXG4gICAgICAvLyBHZXQgbW9kZWwgcGVyZm9ybWFuY2UgZGF0YVxuICAgICAgY29uc3QgeyBkYXRhOiBwZXJmb3JtYW5jZSwgZXJyb3I6IHBlcmZvcm1hbmNlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdtb2RlbF9wZXJmb3JtYW5jZScpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAuZ3RlKCdjcmVhdGVkX2F0JywgZGF0ZVJhbmdlLnN0YXJ0KVxuICAgICAgICAubHRlKCdjcmVhdGVkX2F0JywgZGF0ZVJhbmdlLmVuZClcbiAgICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG5cbiAgICAgIGlmIChwZXJmb3JtYW5jZUVycm9yKSB0aHJvdyBwZXJmb3JtYW5jZUVycm9yXG5cbiAgICAgIC8vIEdldCB1c2VyIGVuZ2FnZW1lbnQgZGF0YVxuICAgICAgY29uc3QgeyBkYXRhOiBlbmdhZ2VtZW50LCBlcnJvcjogZW5nYWdlbWVudEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgndXNlcl9lbmdhZ2VtZW50JylcbiAgICAgICAgLnNlbGVjdChgXG4gICAgICAgICAgKixcbiAgICAgICAgICB1c2Vyczp1c2VyX2lkIChcbiAgICAgICAgICAgIGVtYWlsLFxuICAgICAgICAgICAgZnVsbF9uYW1lXG4gICAgICAgICAgKVxuICAgICAgICBgKVxuICAgICAgICAuZ3RlKCdkYXRlJywgZGF0ZVJhbmdlLnN0YXJ0KVxuICAgICAgICAubHRlKCdkYXRlJywgZGF0ZVJhbmdlLmVuZClcbiAgICAgICAgLm9yZGVyKCdkYXRlJywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG5cbiAgICAgIGlmIChlbmdhZ2VtZW50RXJyb3IpIHRocm93IGVuZ2FnZW1lbnRFcnJvclxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBtZXRyaWNzOiBtZXRyaWNzIHx8IFtdLFxuICAgICAgICBldmVudHM6IGV2ZW50cyB8fCBbXSxcbiAgICAgICAgcGVyZm9ybWFuY2U6IHBlcmZvcm1hbmNlIHx8IFtdLFxuICAgICAgICBlbmdhZ2VtZW50OiBlbmdhZ2VtZW50IHx8IFtdXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCBhbmFseXRpY3MgZGF0YTonLCBlcnJvcilcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBhbmFseXRpY3NTZXJ2aWNlID0gbmV3IEFuYWx5dGljc1NlcnZpY2UoKSJdLCJuYW1lcyI6WyJzdXBhYmFzZSIsIkFuYWx5dGljc1NlcnZpY2UiLCJzZXNzaW9uSWQiLCJnZXRPckNyZWF0ZVNlc3Npb25JZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwic2V0SXRlbSIsInRyYWNrRXZlbnQiLCJldmVudFR5cGUiLCJldmVudERhdGEiLCJ1c2VySWQiLCJldmVudCIsInVzZXJfaWQiLCJldmVudF90eXBlIiwiZXZlbnRfZGF0YSIsInNlc3Npb25faWQiLCJpcF9hZGRyZXNzIiwidXNlcl9hZ2VudCIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsImVycm9yIiwiZnJvbSIsImluc2VydCIsImNvbnNvbGUiLCJ3YXJuIiwidHJhY2tNb2RlbFBlcmZvcm1hbmNlIiwiY29udmVyc2F0aW9uSWQiLCJtb2RlbCIsIm1ldHJpY3MiLCJwZXJmb3JtYW5jZSIsImNvbnZlcnNhdGlvbl9pZCIsInByb21wdF90b2tlbnMiLCJwcm9tcHRUb2tlbnMiLCJjb21wbGV0aW9uX3Rva2VucyIsImNvbXBsZXRpb25Ub2tlbnMiLCJ0b3RhbF90b2tlbnMiLCJ0b3RhbFRva2VucyIsInJlc3BvbnNlX3RpbWVfbXMiLCJyZXNwb25zZVRpbWVNcyIsImNvc3RfY2VudHMiLCJjb3N0Q2VudHMiLCJzdWNjZXNzIiwiZXJyb3JfbWVzc2FnZSIsImVycm9yTWVzc2FnZSIsInVwZGF0ZVVzZXJFbmdhZ2VtZW50IiwidG9kYXkiLCJ0b0lTT1N0cmluZyIsInNwbGl0IiwidXBkYXRlRXJyb3IiLCJ1cGRhdGUiLCJsYXN0X2FjdGl2aXR5IiwidXBkYXRlZF9hdCIsImVxIiwiZW5nYWdlbWVudCIsImRhdGUiLCJtZXNzYWdlc19zZW50IiwiY29udmVyc2F0aW9uc19jcmVhdGVkIiwic2Vzc2lvbl9kdXJhdGlvbl9taW51dGVzIiwibW9kZWxzX3VzZWQiLCJmZWF0dXJlc191c2VkIiwiaW5zZXJ0RXJyb3IiLCJpbmNyZW1lbnRNZXNzYWdlQ291bnQiLCJkYXRhIiwiY3VycmVudERhdGEiLCJmZXRjaEVycm9yIiwic2VsZWN0Iiwic2luZ2xlIiwiY3VycmVudENvdW50IiwidXBzZXJ0RXJyb3IiLCJ1cHNlcnQiLCJvbkNvbmZsaWN0IiwiaW5jcmVtZW50Q29udmVyc2F0aW9uQ291bnQiLCJ0cmFja01vZGVsVXNhZ2UiLCJjb2RlIiwiY3VycmVudE1vZGVscyIsInVwZGF0ZWRNb2RlbHMiLCJBcnJheSIsIlNldCIsInRyYWNrRmVhdHVyZVVzYWdlIiwiZmVhdHVyZSIsImN1cnJlbnRGZWF0dXJlcyIsInVwZGF0ZWRGZWF0dXJlcyIsImdldEFuYWx5dGljc0RhdGEiLCJkYXRlUmFuZ2UiLCJtZXRyaWNzRXJyb3IiLCJndGUiLCJzdGFydCIsImx0ZSIsImVuZCIsIm9yZGVyIiwiYXNjZW5kaW5nIiwiZXZlbnRzIiwiZXZlbnRzRXJyb3IiLCJsaW1pdCIsInBlcmZvcm1hbmNlRXJyb3IiLCJlbmdhZ2VtZW50RXJyb3IiLCJhbmFseXRpY3NTZXJ2aWNlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./src/lib/analyticsService.ts\n");

/***/ })

};
;